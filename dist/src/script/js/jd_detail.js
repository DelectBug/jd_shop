"use strict";var _createClass=function(){function s(i,t){for(var o=0;o<t.length;o++){var s=t[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(i,s.key,s)}}return function(i,t,o){return t&&s(i.prototype,t),o&&s(i,o),i}}();function _classCallCheck(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}$(document).ready(function(){var i=location.search.substring(1).split("=")[1];function t(){_classCallCheck(this,t),this.arrsid=[],this.arrnum=[],this.cart_bth=$(".choose_btns a"),this.sid=$(".jqzoom img").attr("sid"),this.btn_reduce=$(".btn_reduce"),this.btn_add=$(".btn_add"),this.value=$(".buy_num").val()}$.ajax({url:"../php/detail.php",data:{sid:i},dataType:"json"}).done(function(i){var o=i.urllist.split(",");$(".jqzoom img").attr("sid",i.sid);var s="";function t(){_classCallCheck(this,t),this.lh_li=$(".lh li"),this.jqzoom=$(".jqzoom"),this.jqZoomPup=$(".jqZoomPup"),this.zoomdiv=$(".zoomdiv")}$.each(o,function(i,t){$(".jqzoom img").attr("src",o[0]),s+='<li style="width:54px;height:54px;"><img src="'+t+'"/ style="width:50px;height:50px;"></li>'}),$(".lh").html(s),$(".lh").width($(".lh li").size()*$(".lh li").outerWidth(!0)),$(".lh li").eq(0).addClass("img_hover"),$(".zoomdiv").find("img").attr("src",o[0]),(_createClass(t,[{key:"Magnifier_init",value:function(){var i=this;this.lh_li.hover(function(){i.Magnifier_li_hover(this)}),this.jqzoom.hover(function(){i.over(this.lh_li)},function(){i.out()}),this.Magnifier_enlarge()}},{key:"Magnifier_li_hover",value:function(i){$(i).addClass("img_hover").siblings().removeClass("img_hover"),$(".jqzoom img").attr("src",$(i).find("img").attr("src")),$(".zoomdiv img").attr("src",$(i).find("img").attr("src"))}},{key:"over",value:function(){var t=this;this.zoomdiv.css("display","block"),this.bili=this.zoomdiv.find("img").width()/this.jqzoom.find("img").width(),this.jqZoomPup.css({display:"block",width:this.jqzoom.find("img").width()*this.zoomdiv.width()/this.zoomdiv.find("img").width()+"px",height:this.jqzoom.find("img").height()*this.zoomdiv.height()/this.zoomdiv.find("img").height()+"px"}),this.jqzoom.on("mousemove",function(i){t.move(i)})}},{key:"out",value:function(){this.jqZoomPup.css("display","none"),this.zoomdiv.css("display","none")}},{key:"move",value:function(i){var t=i.pageX-this.jqzoom.offset().left-this.jqZoomPup.width()/2,o=i.pageY-this.jqzoom.offset().top-this.jqZoomPup.height()/2;t<=0?t=0:t>=this.jqzoom.find("img").width()-this.jqZoomPup.width()&&(t=this.jqzoom.find("img").width()-this.jqZoomPup.width()),o<=0?o=0:o>=this.jqzoom.find("img").height()-this.jqZoomPup.height()&&(o=this.jqzoom.find("img").height()-this.jqZoomPup.height()),this.jqZoomPup.css({left:t,top:o}),this.zoomdiv.find("img").css({left:-this.bili*t,top:-this.bili*o})}},{key:"Magnifier_enlarge",value:function(){}}]),new t).Magnifier_init()}),(_createClass(t,[{key:"cookie_init",value:function(){var i=this;this.btn_reduce.on("click",function(){i.btn_reduce_click()}),this.btn_add.on("click",function(){console.log(i.btn_add),i.btn_add_click()}),this.cart_bth.on("click",function(){console.log(i),i.btnclick()})}},{key:"btn_reduce_click",value:function(){this.value--,this.value<=1&&(this.value=1,this.btn_reduce.css("cursor","not-allowed"),this.btn_reduce.attr("disabled","true")),1<this.value&&this.btn_reduce.css("cursor","pointer"),$(".buy_num").val(this.value),$(".shopping_cart .ci-count").html(this.value)}},{key:"btn_add_click",value:function(){console.log(this),this.value++,this.btn_reduce.css("cursor","pointer"),$(".buy_num").val(this.value),$(".shopping_cart .ci-count").html(this.value)}},{key:"cookietoarray",value:function(){$.cookie("cookiesid")&&$.cookie("cookienum")&&(this.arrsid=$.cookie("cookiesid").split(","),this.arrnum=$.cookie("cookienum").split(","))}},{key:"btnclick",value:function(){if(console.log(3),this.sid=$(".jqzoom img").attr("sid"),this.cookietoarray(),-1!=$.inArray(this.sid,this.arrsid)){var i=parseInt(this.arrnum[$.inArray(this.sid,this.arrsid)])+parseInt($(".buy_num").val());this.arrnum[$.inArray(this.sid,this.arrsid)]=i,console.log(this.arrnum),$.cookie("cookienum",this.arrnum.toString(),{expires:7}),alert("商品数量更新"),$(".shopping_cart .ci-count").html(i)}else this.arrsid.push(this.sid),$.cookie("cookiesid",this.arrsid.toString(),{expires:7}),this.arrnum.push($(".buy_num").val()),$.cookie("cookienum",this.arrnum.toString(),{expires:7}),alert("商品数量添加")}}]),new t).cookie_init()});